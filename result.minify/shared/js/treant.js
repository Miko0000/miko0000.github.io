(function(){String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(t||0,e.length)===e});var n,s,o,i,a,c,e=null,t={inheritAttrs:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]instanceof Object&&t[n]instanceof Object&&typeof t[n]!="function"?this.inheritAttrs(e[n],t[n]):e[n]=t[n]);return e},createMerge:function(e,t){var n={};return e&&this.inheritAttrs(n,this.cloneObj(e)),t&&this.inheritAttrs(n,t),n},extend:function(){return e?(Array.prototype.unshift.apply(arguments,[!0,{}]),e.extend.apply(e,arguments)):t.createMerge.apply(this,arguments)},cloneObj:function(e){if(Object(e)!==e)return e;var t,n=new e.constructor;for(t in e)e.hasOwnProperty(t)&&(n[t]=this.cloneObj(e[t]));return n},addEvent:function(t,n,s){e?e(t).on(n+".treant",s):t.addEventListener?t.addEventListener(n,s,!1):t.attachEvent?t.attachEvent("on"+n,s):t["on"+n]=s},findEl:function(t,n,s){if(s=s||document,e){var o,i=e(t,s);return n?i.get(0):i}if(t.charAt(0)==="#")return s.getElementById(t.substring(1));if(t.charAt(0)===".")return o=s.getElementsByClassName(t.substring(1)),o.length?o[0]:null;throw new Error("Unknown container element")},getOuterHeight:function(n){var s=1;return typeof n.getBoundingClientRect=="function"?n.getBoundingClientRect().height:e?Math.ceil(e(n).outerHeight())+s:Math.ceil(n.clientHeight+t.getStyle(n,"border-top-width",!0)+t.getStyle(n,"border-bottom-width",!0)+t.getStyle(n,"padding-top",!0)+t.getStyle(n,"padding-bottom",!0)+s)},getOuterWidth:function(n){var s=1;return typeof n.getBoundingClientRect=="function"?n.getBoundingClientRect().width:e?Math.ceil(e(n).outerWidth())+s:Math.ceil(n.clientWidth+t.getStyle(n,"border-left-width",!0)+t.getStyle(n,"border-right-width",!0)+t.getStyle(n,"padding-left",!0)+t.getStyle(n,"padding-right",!0)+s)},getStyle:function(e,t,n){var s="";return document.defaultView&&document.defaultView.getComputedStyle?s=document.defaultView.getComputedStyle(e,"").getPropertyValue(t):e.currentStyle&&(t=t.replace(/-(\w)/g,function(e,t){return t.toUpperCase()}),s=e.currentStyle[t]),n?parseFloat(s):s},addClass:function(n,s){e?e(n).addClass(s):t.hasClass(n,s)||(n.classList?n.classList.add(s):n.className+=" "+s)},hasClass:function(e,t){return(" "+e.className+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")>-1},toggleClass:function(t,n,s){e?e(t).toggleClass(n,s):s?t.classList.add(n):t.classList.remove(n)},setDimensions:function(t,n,s){e?e(t).width(n).height(s):(t.style.width=n+"px",t.style.height=s+"px")},isjQueryAvailable:function(){return typeof e!="undefined"&&e}},r=function(){this.reset()};r.prototype={reset:function(){return this.loading=[],this},processNode:function(e){for(var t=e.nodeDOM.getElementsByTagName("img"),n=t.length;n--;)this.create(e,t[n]);return this},removeAll:function(e){for(var t=this.loading.length;t--;)this.loading[t]===e&&this.loading.splice(t,1);return this},create:function(e,n){var i=this,o=n.src;function s(){i.removeAll(o),e.width=e.nodeDOM.offsetWidth,e.height=e.nodeDOM.offsetHeight}if(n.src.indexOf("data:")!==0){if(this.loading.push(o),n.complete)return s();t.addEvent(n,"load",s),t.addEvent(n,"error",s),n.src+=(n.src.indexOf("?")>0?"&":"?")+(new Date).getTime()}else s()},isNotLoading:function(){return this.loading.length===0}},s={store:[],createTree:function(e){var t=this.store.length;return this.store.push(new o(e,t)),this.get(t)},get:function(e){return this.store[e]},destroy:function(e){if(n=this.get(e),n){for(n._R.remove(),t=n.drawArea;t.firstChild;)t.removeChild(t.firstChild);for(var t,n,s,i=t.className.split(" "),a=[],o=0;o<i.length;o++)s=i[o],s!=="Treant"&&s!=="Treant-loaded"&&a.push(s);t.style.overflowY="",t.style.overflowX="",t.className=a.join(" "),this.store[e]=null}return this}},o=function(e,n){this.reset=function(e,n){if(this.initJsonConfig=e,this.initTreeId=n,this.id=n,this.CONFIG=t.extend(o.CONFIG,e.chart),this.drawArea=t.findEl(this.CONFIG.container,!0),!this.drawArea)throw new Error('Failed to find element by selector "'+this.CONFIG.container+'"');return t.addClass(this.drawArea,"Treant"),this.drawArea.innerHTML="",this.imageLoader=new r,this.nodeDB=new i(e.nodeStructure,this),this.connectionStore={},this.loaded=!1,this._R=new Raphael(this.drawArea,100,100),this},this.reload=function(){return this.reset(this.initJsonConfig,this.initTreeId).redraw(),this},this.reset(e,n)},o.prototype={getNodeDb:function(){return this.nodeDB},addNode:function(e,t){this.CONFIG.callback.onBeforeAddNode.apply(this,[e,t]);var n=this.nodeDB.createNode(t,e.id,this);return n.createGeometry(this),n.parent().createSwitchGeometry(this),this.positionTree(),this.CONFIG.callback.onAfterAddNode.apply(this,[n,e,t]),n},redraw:function(){return this.positionTree(),this},positionTree:function(e){var n,s=this;return this.imageLoader.isNotLoading()?(n=this.root(),this.resetLevelData(),this.firstWalk(n,0),this.secondWalk(n,0,0,0),this.positionNodes(),this.CONFIG.animateOnInit&&setTimeout(function(){n.toggleCollapse()},this.CONFIG.animateOnInitDelay),this.loaded||(t.addClass(this.drawArea,"Treant-loaded"),Object.prototype.toString.call(e)==="[object Function]"&&e(s),s.CONFIG.callback.onTreeLoaded.apply(s,[n]),this.loaded=!0)):setTimeout(function(){s.positionTree(e)},10),this},firstWalk:function(e,t){if(e.prelim=null,e.modifier=null,this.setNeighbors(e,t),this.calcLevelDim(e,t),n=e.leftSibling(),e.childrenCount()===0||t==this.CONFIG.maxDepth)n?e.prelim=n.prelim+n.size()+this.CONFIG.siblingSeparation:e.prelim=0;else{for(var n,o,s=0,i=e.childrenCount();s<i;s++)this.firstWalk(e.childAt(s),t+1);o=e.childrenCenter()-e.size()/2,n?(e.prelim=n.prelim+n.size()+this.CONFIG.siblingSeparation,e.modifier=e.prelim-o,this.apportion(e,t)):e.prelim=o,e.stackParent?e.modifier+=this.nodeDB.get(e.stackChildren[0]).size()/2+e.connStyle.stackIndent:e.stackParentId&&(e.prelim=0)}return this},apportion:function(e,t){for(var s,o,i,h,f,n=e.firstChild(),c=n.leftNeighbor(),l=1,p=this.CONFIG.maxDepth-t;n&&c&&l<=p;){for(var d=0,m=0,a=c,r=n,u=0;u<l;u++)a=a.parent(),r=r.parent(),m+=a.modifier,d+=r.modifier,r.stackParent!==void 0&&(d+=r.size()/2);if(i=c.prelim+m+c.size()+this.CONFIG.subTeeSeparation-(n.prelim+d),i>0){for(o=e,h=0;o&&o.id!==a.id;)o=o.leftSibling(),h++;if(o)for(s=e,f=i/h;s.id!==a.id;)s.prelim+=i,s.modifier+=i,i-=f,s=s.leftSibling()}l++,n=n.childrenCount()===0?e.leftMost(0,l):n=n.firstChild(),n&&(c=n.leftNeighbor())}},secondWalk:function(e,t,n,s){if(t>this.CONFIG.maxDepth)return;var i,a,l,d=e.prelim+n,r=s,c=this.CONFIG.nodeAlign,o=this.CONFIG.rootOrientation;o==="NORTH"||o==="SOUTH"?(i=this.levelMaxDim[t].height,a=e.height,e.pseudo&&(e.height=i)):(o==="WEST"||o==="EAST")&&(i=this.levelMaxDim[t].width,a=e.width,e.pseudo&&(e.width=i)),e.X=d,e.pseudo?o==="NORTH"||o==="WEST"?e.Y=r:(o==="SOUTH"||o==="EAST")&&(e.Y=r+(i-a)):e.Y=c==="CENTER"?r+(i-a)/2:c==="TOP"?r+(i-a):r,(o==="WEST"||o==="EAST")&&(l=e.X,e.X=e.Y,e.Y=l),o==="SOUTH"?e.Y=-e.Y-a:o==="EAST"&&(e.X=-e.X-a),e.childrenCount()!==0&&(e.id===0&&this.CONFIG.hideRootNode?this.secondWalk(e.firstChild(),t+1,n+e.modifier,s):this.secondWalk(e.firstChild(),t+1,n+e.modifier,s+i+this.CONFIG.levelSeparation)),e.rightSibling()&&this.secondWalk(e.rightSibling(),t,n,s)},positionNodes:function(){var a,l,n=this,t={x:n.nodeDB.getMinMaxCoord("X",null,null),y:n.nodeDB.getMinMaxCoord("Y",null,null)},r=t.x.max-t.x.min,c=t.y.max-t.y.min,o={x:t.x.max-r/2,y:t.y.max-c/2};this.handleOverflow(r,c);var e,s,u,i={x:n.drawArea.clientWidth/2,y:n.drawArea.clientHeight/2},d=i.x-o.x,h=i.y-o.y,f=t.x.min+d<=0?Math.abs(t.x.min):0,m=t.y.min+h<=0?Math.abs(t.y.min):0;for(s=0,u=this.nodeDB.db.length;s<u;s++){if(e=this.nodeDB.get(s),n.CONFIG.callback.onBeforePositionNode.apply(n,[e,s,i,o]),e.id===0&&this.CONFIG.hideRootNode){n.CONFIG.callback.onAfterPositionNode.apply(n,[e,s,i,o]);continue}e.X+=f+(r<this.drawArea.clientWidth?d:this.CONFIG.padding),e.Y+=m+(c<this.drawArea.clientHeight?h:this.CONFIG.padding),l=e.collapsedParent(),a=null,l?(a=l.connectorPoint(!0),e.hide(a)):e.positioned?e.show():(e.nodeDOM.style.left=e.X+"px",e.nodeDOM.style.top=e.Y+"px",e.positioned=!0),e.id!==0&&!(e.parent().id===0&&this.CONFIG.hideRootNode)?this.setConnectionToParent(e,a):!this.CONFIG.hideRootNode&&e.drawLineThrough&&e.drawLineThroughMe(),n.CONFIG.callback.onAfterPositionNode.apply(n,[e,s,i,o])}return this},handleOverflow:function(n,s){var o,r,c,i=n<this.drawArea.clientWidth?this.drawArea.clientWidth:n+this.CONFIG.padding*2,a=s<this.drawArea.clientHeight?this.drawArea.clientHeight:s+this.CONFIG.padding*2;return this._R.setSize(i,a),this.CONFIG.scrollbar==="resize"?t.setDimensions(this.drawArea,i,a):!t.isjQueryAvailable()||this.CONFIG.scrollbar==="native"?(this.drawArea.clientWidth<n&&(this.drawArea.style.overflowX="auto"),this.drawArea.clientHeight<s&&(this.drawArea.style.overflowY="auto")):this.CONFIG.scrollbar==="fancy"&&(o=e(this.drawArea),o.hasClass("ps-container")?(o.find(".Treant").css({width:i,height:a}),o.perfectScrollbar("update")):(r=o.wrapInner('<div class="Treant"/>'),c=r.find(".Treant"),c.css({width:i,height:a}),r.perfectScrollbar())),this},setConnectionToParent:function(e,t){var n,o=e.stackParentId,s=o?this.nodeDB.get(o):e.parent(),i=t?this.getPointPathString(t):this.getPathString(s,e,o);return this.connectionStore[e.id]?(n=this.connectionStore[e.id],this.animatePath(n,i)):(n=this._R.path(i),this.connectionStore[e.id]=n,e.pseudo&&delete s.connStyle.style["arrow-end"],s.pseudo&&delete s.connStyle.style["arrow-start"],n.attr(s.connStyle.style),(e.drawLineThrough||e.pseudo)&&e.drawLineThroughMe(t)),e.connector=n,this},getPointPathString:function(e){return["_M",e.x,",",e.y,"L",e.x,",",e.y,e.x,",",e.y].join(" ")},animatePath:function(e,t){return e.hidden&&t.charAt(0)!=="_"&&(e.show(),e.hidden=!1),e.animate({path:t.charAt(0)==="_"?t.substring(1):t},this.CONFIG.animation.connectorsSpeed,this.CONFIG.animation.connectorsAnimation,function(){t.charAt(0)==="_"&&(e.hide(),e.hidden=!0)}),this},getPathString:function(e,t,n){var u,m,o=e.connectorPoint(!0),s=t.connectorPoint(!1),i=this.CONFIG.rootOrientation,a=e.connStyle.type,r={},c={};i==="NORTH"||i==="SOUTH"?(r.y=c.y=(o.y+s.y)/2,r.x=o.x,c.x=s.x):(i==="EAST"||i==="WEST")&&(r.x=c.x=(o.x+s.x)/2,r.y=o.y,c.y=s.y);var d,p,l=o.x+","+o.y,f=r.x+","+r.y,g=c.x+","+c.y,h=s.x+","+s.y,v=(r.x+c.x)/2+","+(r.y+c.y)/2;return n?(p=i==="EAST"||i==="WEST"?s.x+","+o.y:o.x+","+s.y,a==="step"||a==="straight"?d=["M",l,"L",p,"L",h]:(a==="curve"||a==="bCurve")&&(u=e.connStyle.stackIndent,i==="NORTH"?m=s.x-u+","+(s.y-u):i==="SOUTH"?m=s.x-u+","+(s.y+u):i==="EAST"?m=s.x+u+","+o.y:i==="WEST"&&(m=s.x-u+","+o.y),d=["M",l,"L",m,"S",p,h])):a==="step"?d=["M",l,"L",f,"L",g,"L",h]:a==="curve"?d=["M",l,"C",f,g,h]:a==="bCurve"?d=["M",l,"Q",f,v,"T",h]:a==="straight"&&(d=["M",l,"L",l,h]),d.join(" ")},setNeighbors:function(e,t){return e.leftNeighborId=this.lastNodeOnLevel[t],e.leftNeighborId&&(e.leftNeighbor().rightNeighborId=e.id),this.lastNodeOnLevel[t]=e.id,this},calcLevelDim:function(e,t){return this.levelMaxDim[t]={width:Math.max(this.levelMaxDim[t]?this.levelMaxDim[t].width:0,e.width),height:Math.max(this.levelMaxDim[t]?this.levelMaxDim[t].height:0,e.height)},this},resetLevelData:function(){return this.lastNodeOnLevel=[],this.levelMaxDim=[],this},root:function(){return this.nodeDB.get(0)}},i=function(e,t){this.reset(e,t)},i.prototype={reset:function(e,n){this.db=[];var s=this;function o(e,i){if(a=s.createNode(e,i,n,null),e.children){if(e.childrenDropLevel&&e.childrenDropLevel>0)for(;e.childrenDropLevel--;)l=t.cloneObj(a.connStyle),a=s.createNode("pseudo",a.id,n,null),a.connStyle=l,a.children=[];c=e.stackChildren&&!s.hasGrandChildren(e)?a.id:null,c!==null&&(a.stackChildren=[]);for(var a,c,l,r=0,d=e.children.length;r<d;r++)c!==null?(a=s.createNode(e.children[r],a.id,n,c),r+1<d&&(a.children=[])):o(e.children[r],a.id)}}return n.CONFIG.animateOnInit&&(e.collapsed=!0),o(e,-1),this.createGeometries(n),this},createGeometries:function(e){for(var t=this.db.length;t--;)this.get(t).createGeometry(e);return this},get:function(e){return this.db[e]},walk:function(e){for(var t=this.db.length;t--;)e.apply(this,[this.get(t)]);return this},createNode:function(e,t,s,o){var i,r,a=new n(e,this.db.length,t,s,o);return this.db.push(a),t>=0&&(i=this.get(t),e.position?e.position==="left"?i.children.push(a.id):e.position==="right"?i.children.splice(0,0,a.id):e.position==="center"?i.children.splice(Math.floor(i.children.length/2),0,a.id):(r=parseInt(e.position),i.children.length===1&&r>0?i.children.splice(0,0,a.id):i.children.splice(Math.max(r,i.children.length-1),0,a.id)):i.children.push(a.id)),o&&(this.get(o).stackParent=!0,this.get(o).stackChildren.push(a.id)),a},getMinMaxCoord:function(e,t,n){for(t=t||this.get(0),n=n||{min:t[e],max:t[e]+(e==="X"?t.width:t.height)},o=t.childrenCount();o--;){var o,s=t.childAt(o),i=s[e]+(e==="X"?s.width:s.height),a=s[e];i>n.max&&(n.max=i),a<n.min&&(n.min=a),this.getMinMaxCoord(e,s,n)}return n},hasGrandChildren:function(e){for(var t=e.children.length;t--;)if(e.children[t].children&&e.children[t].children.length>0)return!0;return!1}},n=function(e,t,n,s,o){this.reset(e,t,n,s,o)},n.prototype={reset:function(e,n,s,o,i){return this.id=n,this.parentId=s,this.treeId=o.id,this.prelim=0,this.modifier=0,this.leftNeighborId=null,this.stackParentId=i,this.pseudo=e==="pseudo"||e.pseudo,this.meta=e.meta||{},this.image=e.image||null,this.link=t.createMerge(o.CONFIG.node.link,e.link),this.connStyle=t.createMerge(o.CONFIG.connectors,e.connectors),this.connector=null,this.drawLineThrough=e.drawLineThrough!==!1&&(e.drawLineThrough||o.CONFIG.node.drawLineThrough),this.collapsable=e.collapsable!==!1&&(e.collapsable||o.CONFIG.node.collapsable),this.collapsed=e.collapsed,this.text=e.text,this.nodeInnerHTML=e.innerHTML,this.nodeHTMLclass=(o.CONFIG.node.HTMLclass?o.CONFIG.node.HTMLclass:"")+(e.HTMLclass?" "+e.HTMLclass:""),this.nodeHTMLid=e.HTMLid,this.children=[],this},getTree:function(){return s.get(this.treeId)},getTreeConfig:function(){return this.getTree().CONFIG},getTreeNodeDb:function(){return this.getTree().getNodeDb()},lookupNode:function(e){return this.getTreeNodeDb().get(e)},Tree:function(){return s.get(this.treeId)},dbGet:function(e){return this.getTreeNodeDb().get(e)},size:function(){var e=this.getTreeConfig().rootOrientation;if(this.pseudo)return-this.getTreeConfig().subTeeSeparation;if(e==="NORTH"||e==="SOUTH")return this.width;if(e==="WEST"||e==="EAST")return this.height},childrenCount:function(){return this.collapsed||!this.children?0:this.children.length},childAt:function(e){return this.dbGet(this.children[e])},firstChild:function(){return this.childAt(0)},lastChild:function(){return this.childAt(this.children.length-1)},parent:function(){return this.lookupNode(this.parentId)},leftNeighbor:function(){if(this.leftNeighborId)return this.lookupNode(this.leftNeighborId)},rightNeighbor:function(){if(this.rightNeighborId)return this.lookupNode(this.rightNeighborId)},leftSibling:function(){var e=this.leftNeighbor();if(e&&e.parentId===this.parentId)return e},rightSibling:function(){var e=this.rightNeighbor();if(e&&e.parentId===this.parentId)return e},childrenCenter:function(){var e=this.firstChild(),t=this.lastChild();return e.prelim+(t.prelim-e.prelim+t.size())/2},collapsedParent:function(){var e=this.parent();return!!e&&(e.collapsed?e:e.collapsedParent())},leftMost:function(e,t){if(e>=t)return this;if(this.childrenCount()===0)return;for(var s,n=0,o=this.childrenCount();n<o;n++)if(s=this.childAt(n).leftMost(e+1,t),s)return s},connectorPoint:function(e){var t=this.Tree().CONFIG.rootOrientation,n={};return this.stackParentId&&(t==="NORTH"||t==="SOUTH"?t="WEST":(t==="EAST"||t==="WEST")&&(t="NORTH")),t==="NORTH"?(n.x=this.pseudo?this.X-this.Tree().CONFIG.subTeeSeparation/2:this.X+this.width/2,n.y=e?this.Y+this.height:this.Y):t==="SOUTH"?(n.x=this.pseudo?this.X-this.Tree().CONFIG.subTeeSeparation/2:this.X+this.width/2,n.y=e?this.Y:this.Y+this.height):t==="EAST"?(n.x=e?this.X:this.X+this.width,n.y=this.pseudo?this.Y-this.Tree().CONFIG.subTeeSeparation/2:this.Y+this.height/2):t==="WEST"&&(n.x=e?this.X+this.width:this.X,n.y=this.pseudo?this.Y-this.Tree().CONFIG.subTeeSeparation/2:this.Y+this.height/2),n},pathStringThrough:function(){var e=this.connectorPoint(!0),t=this.connectorPoint(!1);return["M",e.x+","+e.y,"L",t.x+","+t.y].join(" ")},drawLineThroughMe:function(e){var n,s=e?this.Tree().getPointPathString(e):this.pathStringThrough();this.lineThroughMe=this.lineThroughMe||this.Tree()._R.path(s),n=t.cloneObj(this.connStyle.style),delete n["arrow-start"],delete n["arrow-end"],this.lineThroughMe.attr(n),e&&(this.lineThroughMe.hide(),this.lineThroughMe.hidden=!0)},addSwitchEvent:function(e){var n=this;t.addEvent(e,"click",function(t){if(t.preventDefault(),n.getTreeConfig().callback.onBeforeClickCollapseSwitch.apply(n,[e,t])===!1)return!1;n.toggleCollapse(),n.getTreeConfig().callback.onAfterClickCollapseSwitch.apply(n,[e,t])})},collapse:function(){return this.collapsed||this.toggleCollapse(),this},expand:function(){return this.collapsed&&this.toggleCollapse(),this},toggleCollapse:function(){var n,e=this.getTree();return e.inAnimation||(e.inAnimation=!0,this.collapsed=!this.collapsed,t.toggleClass(this.nodeDOM,"collapsed",this.collapsed),e.positionTree(),n=this,setTimeout(function(){e.inAnimation=!1,e.CONFIG.callback.onToggleCollapseFinished.apply(e,[n,n.collapsed])},e.CONFIG.animation.nodeSpeed>e.CONFIG.animation.connectorsSpeed?e.CONFIG.animation.nodeSpeed:e.CONFIG.animation.connectorsSpeed)),this},hide:function(t){t=t||!1,s=this.hidden,this.hidden=!0,this.nodeDOM.style.overflow="hidden";var s,a,o=this.getTree(),i=this.getTreeConfig(),n={opacity:0};return t&&(n.left=t.x,n.top=t.y),!this.positioned||s?(this.nodeDOM.style.visibility="hidden",e?e(this.nodeDOM).css(n):(this.nodeDOM.style.left=n.left+"px",this.nodeDOM.style.top=n.top+"px"),this.positioned=!0):e?e(this.nodeDOM).animate(n,i.animation.nodeSpeed,i.animation.nodeAnimation,function(){this.style.visibility="hidden"}):(this.nodeDOM.style.transition="all "+i.animation.nodeSpeed+"ms ease",this.nodeDOM.style.transitionProperty="opacity, left, top",this.nodeDOM.style.opacity=n.opacity,this.nodeDOM.style.left=n.left+"px",this.nodeDOM.style.top=n.top+"px",this.nodeDOM.style.visibility="hidden"),this.lineThroughMe&&(a=o.getPointPathString(t),s?this.lineThroughMe.attr({path:a}):o.animatePath(this.lineThroughMe,o.getPointPathString(t))),this},hideConnector:function(){var e=this.Tree(),t=e.connectionStore[this.id];return t&&t.animate({opacity:0},e.CONFIG.animation.connectorsSpeed,e.CONFIG.animation.connectorsAnimation),this},show:function(){this.hidden=!1,this.nodeDOM.style.visibility="visible";var s=this.Tree(),t={left:this.X,top:this.Y,opacity:1},n=this.getTreeConfig();return e?e(this.nodeDOM).animate(t,n.animation.nodeSpeed,n.animation.nodeAnimation,function(){this.style.overflow=""}):(this.nodeDOM.style.transition="all "+n.animation.nodeSpeed+"ms ease",this.nodeDOM.style.transitionProperty="opacity, left, top",this.nodeDOM.style.left=t.left+"px",this.nodeDOM.style.top=t.top+"px",this.nodeDOM.style.opacity=t.opacity,this.nodeDOM.style.overflow=""),this.lineThroughMe&&this.getTree().animatePath(this.lineThroughMe,this.pathStringThrough()),this},showConnector:function(){var e=this.Tree(),t=e.connectionStore[this.id];return t&&t.animate({opacity:1},e.CONFIG.animation.connectorsSpeed,e.CONFIG.animation.connectorsAnimation),this}},n.prototype.buildNodeFromText=function(e){if(this.image&&(image=document.createElement("img"),image.src=this.image,e.appendChild(image)),this.text)for(t in this.text)if(t.startsWith("data-"))e.setAttribute(t,this.text[t]);else{var t,n=document.createElement(this.text[t].href?"a":"p");this.text[t].href&&(n.href=this.text[t].href,this.text[t].target&&(n.target=this.text[t].target)),n.className="node-"+t,n.appendChild(document.createTextNode(this.text[t].val?this.text[t].val:this.text[t]instanceof Object?"'val' param missing!":this.text[t])),e.appendChild(n)}return e},n.prototype.buildNodeFromHtml=function(e){if(this.nodeInnerHTML.charAt(0)==="#"){var t=document.getElementById(this.nodeInnerHTML.substring(1));t?(e=t.cloneNode(!0),e.id+="-clone",e.className+=" node"):e.innerHTML="<b> Wrong ID selector </b>"}else e.innerHTML=this.nodeInnerHTML;return e},n.prototype.createGeometry=function(t){if(this.id===0&&t.CONFIG.hideRootNode){this.width=0,this.height=0;return}var i,o=t.drawArea,s=document.createElement(this.link.href?"a":"div");s.className=!this.pseudo?n.CONFIG.nodeHTMLclass:"pseudo",this.nodeHTMLclass&&!this.pseudo&&(s.className+=" "+this.nodeHTMLclass),this.nodeHTMLid&&(s.id=this.nodeHTMLid),this.link.href&&(s.href=this.link.href,s.target=this.link.target),e?e(s).data("treenode",this):s.data={treenode:this},this.pseudo||(s=this.nodeInnerHTML?this.buildNodeFromHtml(s):this.buildNodeFromText(s),(this.collapsed||this.collapsable&&this.childrenCount()&&!this.stackParentId)&&this.createSwitchGeometry(t,s)),t.CONFIG.callback.onCreateNode.apply(t,[this,s]),o.appendChild(s),this.width=s.offsetWidth,this.height=s.offsetHeight,this.nodeDOM=s,t.imageLoader.processNode(this)},n.prototype.createSwitchGeometry=function(e,n){n=n||this.nodeDOM;var s=t.findEl(".collapse-switch",!0,n);return s||(s=document.createElement("a"),s.className="collapse-switch",n.appendChild(s),this.addSwitchEvent(s),this.collapsed&&(n.className+=" collapsed"),e.CONFIG.callback.onCreateNodeCollapseSwitch.apply(e,[this,n,s])),s},o.CONFIG={maxDepth:100,rootOrientation:"NORTH",nodeAlign:"CENTER",levelSeparation:30,siblingSeparation:30,subTeeSeparation:30,hideRootNode:!1,animateOnInit:!1,animateOnInitDelay:500,padding:15,scrollbar:"native",connectors:{type:"curve",style:{stroke:"black"},stackIndent:15},node:{link:{target:"_self"}},animation:{nodeSpeed:450,nodeAnimation:"linear",connectorsSpeed:450,connectorsAnimation:"linear"},callback:{onCreateNode:function(){},onCreateNodeCollapseSwitch:function(){},onAfterAddNode:function(){},onBeforeAddNode:function(){},onAfterPositionNode:function(){},onBeforePositionNode:function(){},onToggleCollapseFinished:function(){},onAfterClickCollapseSwitch:function(){},onBeforeClickCollapseSwitch:function(){},onTreeLoaded:function(){}}},n.CONFIG={nodeHTMLclass:"node"},c={make:function(e){var t,n=e.length;for(this.jsonStructure={chart:null,nodeStructure:null};n--;){if(t=e[n],t.hasOwnProperty("container")){this.jsonStructure.chart=t;continue}!t.hasOwnProperty("parent")&&!t.hasOwnProperty("container")&&(this.jsonStructure.nodeStructure=t,t._json_id=0)}return this.findChildren(e),this.jsonStructure},findChildren:function(e){for(n=[0];n.length;){for(var t,n,i=n.pop(),a=this.findNode(this.jsonStructure.nodeStructure,i),s=0,r=e.length,o=[];s<r;s++)t=e[s],t.parent&&t.parent._json_id===i&&(t._json_id=this.getID(),delete t.parent,o.push(t),n.push(t._json_id));o.length&&(a.children=o)}},findNode:function(e,t){if(e._json_id===t)return e;if(e.children){n=e.children.length;for(var n,s;n--;)if(s=this.findNode(e.children[n],t),s)return s}},getID:function(){var e=1;return function(){return e++}}()},a=function(t,n,o){t instanceof Array&&(t=c.make(t)),o&&(e=o),this.tree=s.createTree(t),this.tree.positionTree(n)},a.prototype.destroy=function(){s.destroy(this.tree.id)},window.Treant=a})()